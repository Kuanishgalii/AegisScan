# AegisScan

AegisScan — это сканер веб-уязвимостей, написанный на Python, который выполняет несколько базовых задач для анализа веб-сайтов. 

 Цель инструмента — помочь системным администраторам, веб-разработчикам и специалистам по безопасности обнаружить потенциальные уязвимости и неправильно настроенные серверы на веб-сайтах.
 
    Особенности:
    
        Быстрая и простая настройка.
        
        Многопоточная обработка для ускоренного сканирования.
        
        Простой вывод в консоль для быстрой диагностики.

Он выполняет проверку на уязвимости и неправильно настроенные серверы с помощью следующих функций:

1. Проверка стандартных уязвимых путей

    Проверяет наличие стандартных уязвимых путей на веб-сайтах, таких как:
        /robots.txt
        /phpinfo.php
        /git/config
        /env
    Эти пути могут раскрывать важную информацию, например, конфигурационные файлы или чувствительные данные.

2. Обнаружение CMS (системы управления контентом)

    Инструмент пытается определить, какую CMS использует сайт (например, WordPress, Joomla, Drupal, Bitrix и другие).
    Это полезно для поиска уязвимостей в специфичных для каждой CMS компонентах (например, темы, плагины, ядро).

3. Проверка заголовков и конфигурации сервера

    Проверяет ключевые HTTP-заголовки, которые могут раскрывать информацию о сервере, таких как:
        X-Powered-By — указывает на используемые технологии (например, PHP).
        Strict-Transport-Security — важен для защиты от MITM-атак.
        X-Frame-Options, X-XSS-Protection — защиты от XSS-атак и кликов на фреймах.
    Проверка этих заголовков помогает убедиться в правильной настройке безопасности сервера.

4. Многопоточность

   Для ускорения сканирования инструмент использует многопоточность с помощью ThreadPoolExecutor, что позволяет одновременно выполнять несколько проверок (например, проверку уязвимых путей и заголовков).

5. Поиск уязвимостей в CMS

   Для популярных CMS инструмент показывает ссылки на ресурсы, где можно найти известные уязвимости, связанные с этой системой. Например, для WordPress будут выведены ссылки на базы данных уязвимостей.

6. Логирование и вывод

   Все обнаруженные уязвимости, проблемы с заголовками, или CMS, а также ошибки, записываются в лог, который можно использовать для дальнейшего анализа.

Инструмент AegisScan подходит для использования как в тестах на безопасность, так и в случае необходимости диагностики и улучшения безопасности веб-сайтов, которые вы контролируете или тестируете.

-----

Установка зависимостей

Для того чтобы инструмент работал, нужно установить библиотеку requests, которая используется для выполнения HTTP-запросов. Вы можете установить её с помощью pip:

------

pip install requests

------

Подготовка инструмента

После того как вы скачали или скопировали код инструмента, его можно настроить и использовать. Для этого достаточно настроить URL и запустить скрипт.

3. Настройка URL

Чтобы сканировать определённый сайт, вам нужно заменить переменную test_url в скрипте на нужный вам URL. Например, если вы хотите сканировать сайт http://example.com, замените:

test_url = "http://example.com"

на:

test_url = "http://ваш_сайт.com"

-----

Запуск инструмента

После того как URL был настроен, вы можете запустить скрипт с помощью Python. В директории с файлом, например, aegis_scan.py, выполните:

python aegis_scan.py

-----

Как работает инструмент

Когда вы запускаете инструмент, он выполняет несколько проверок и операций на указанном сайте:

    Проверка уязвимых путей:
        Проверяются стандартные уязвимые пути на сайте, такие как:
            /robots.txt
            /phpinfo.php
            /git/config
            /env
        Если какой-либо из этих путей доступен, выводится предупреждение.

    Обнаружение CMS:
        Скрипт пытается определить, какая система управления контентом (CMS) используется на сайте. Он проверяет:
            Мета-теги
            Специфичные файлы
            Заголовки ответа HTTP
        Если CMS обнаружена, она выводится в логе, например: Обнаружена CMS WordPress.

    Проверка заголовков сервера:
    
        Проверяется набор стандартных заголовков HTTP, которые могут указывать на безопасность сервера:
            X-Powered-By
            Server
            Strict-Transport-Security
            X-Content-Type-Options
            X-Frame-Options
            X-XSS-Protection
            Content-Security-Policy
            
        Если какой-либо из этих заголовков отсутствует или есть проблемы, они выводятся в лог.

    Поиск уязвимостей для CMS:
    
    Если на сайте была обнаружена CMS (например, WordPress, Joomla, Drupal и т.д.), инструмент покажет ссылки на ресурсы, где можно проверить известные уязвимости для этой CMS.


Пример вывода

Когда вы запустите инструмент, в консоли появится вывод, в котором будут указаны результаты проверки:

2025-02-19 14:30:00 - INFO - Заголовок найден: X-Powered-By: PHP/7.4.3
2025-02-19 14:30:00 - INFO - Заголовок найден: Server: Apache
2025-02-19 14:30:00 - WARNING - Заголовок отсутствует: X-Frame-Options
2025-02-19 14:30:02 - WARNING - Найден уязвимый путь: http://example.com/robots.txt
2025-02-19 14:30:02 - INFO - Обнаружена CMS wordpress по мета-тегу.

2025-02-19 14:30:02 - INFO - Просмотр уязвимостей на https://wpvulndb.com/

------

Дополнительные настройки и улучшения

Установка максимального числа потоков: Вы можете настроить максимальное количество потоков для многозадачности. 

-----

Например, в строке:

with ThreadPoolExecutor(max_workers=10) as executor: вы можете изменить число потоков, например, на max_workers=5 или max_workers=20 в зависимости от возможностей вашего компьютера или сети.

Изменение списка проверяемых путей: Вы можете добавить или изменить список путей, проверяемых на уязвимости. Для этого измените список в функции check_vulnerable_paths:

    vulnerable_paths = ['/robots.txt', '/phpinfo.php', '/.git/config', '/.env']

Добавление или удаление CMS: Если вы хотите добавить новые CMS для проверки, вам нужно расширить словарь CMS_SIGNATURES, добавив новые ключи для каждой CMS с соответствующими признаками.

-----

Примечания

Рекомендуется использовать инструмент на тестовых или нерабочих веб-сайтах, поскольку он может выявить уязвимости или раскрыть конфиденциальную информацию на сервере.

-----

Используйте его только в законных целях!
